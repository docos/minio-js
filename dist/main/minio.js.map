{"version":3,"sources":["minio.js"],"names":["Package","require","Client","params","secure","Error","useSSL","port","endPoint","errors","InvalidEndpointError","InvalidArgumentError","region","host","toLowerCase","protocol","transport","Http","Https","libraryComments","process","platform","arch","libraryAgent","version","dnsLookup","accessKey","secretKey","sessionToken","userAgent","anonymous","regionMap","partSize","overRidePartSize","maximumPartSize","maxObjectSize","enableSHA256","reqOptions","options","TypeError","_","pick","opts","method","bucketName","objectName","headers","query","virtualHostStyle","path","pathStyle","map","v","k","Object","assign","appName","appVersion","trim","size","response","err","logStream","logHeaders","forEach","redacter","RegExp","replace","write","statusCode","errJSON","JSON","stringify","stream","stdout","payload","returnResponse","cb","length","sha256sum","Crypto","createHash","update","digest","makeRequestStream","_makeRequest","e","getRequestOptions","date","Date","authorization","req","request","errorTransformer","transformers","getErrorTransformer","on","logHTTP","pipe","getBucketRegion","InvalidBucketNameError","extractRegion","transformer","getBucketRegionTransformer","data","window","makeRequest","name","Region","createBucketConfiguration","push","_attr","xmlns","LocationConstraint","payloadObject","CreateBucketConfiguration","getListBucketTransformer","buckets","result","bucket","prefix","recursive","undefined","InvalidPrefixError","delimiter","keyMarker","uploadIdMarker","uploads","ended","readStream","Stream","Readable","objectMode","_read","shift","listIncompleteUploadsQuery","emit","prefixes","async","eachSeries","upload","listParts","key","uploadId","parts","reduce","acc","item","isTruncated","nextKeyMarker","nextUploadIdMarker","code","isValidBucketNameError","InvalidObjectNameError","removeUploadId","during","findUploadId","filePath","partFile","partFileStream","objStat","rename","fs","waterfall","statObject","dirname","ignore","etag","stat","stats","offset","createWriteStream","flags","getPartialObject","downloadStream","range","expectedStatus","metaData","callback","multipart","uploader","getUploader","hash","getHashSummer","start","end","autoClose","createReadStream","md5sum","etags","initiateNewMultipartUpload","calculatePartSize","part","partsDone","partNumber","uploadedSize","whilst","md5sumHex","Buffer","from","toString","completeMultipartUpload","rest","chunker","BlockStream2","zeroPadding","ObjectUploader","arg1","arg2","arg3","arg4","arg5","srcObject","conditions","CopyConditions","modified","unmodified","matchETag","matchEtagExcept","matchETagExcept","getCopyObjectTransformer","marker","maxKeys","queries","sort","join","getListObjectsTransformer","objects","listObjectsQuery","nextMarker","continuationToken","startAfter","getListObjectsV2Transformer","listObjectsV2Query","nextContinuationToken","lastModified","objectsList","maxEntries","entry","list","listOfList","encoder","util","TextEncoder","deleteObjects","value","encode","md5digest","policy","getConcater","InvalidBucketPolicyError","expires","reqParams","requestDate","AnonymousRequestError","querystring","url","pe","respHeaders","validRespHeaders","header","presignedUrl","PostPolicy","postPolicy","formData","dateStr","expiration","setSeconds","setExpires","policyBase64","signature","portStr","urlStr","postURL","getInitiateMultipartTransformer","element","Part","PartNumber","ETag","CompleteMultipartUpload","getCompleteMultipartTransformer","errCode","S3Error","errMessage","listNext","listPartsQuery","concat","getListPartsTransformer","maxUploads","unshift","getListMultipartTransformer","latestUpload","initiated","getTime","validate","simpleUploader","args","multipartUploader","config","builder","xml2js","Builder","rootName","renderOpts","headless","buildObject","setBucketNotification","NotificationConfig","getBucketNotificationTransformer","bucketNotification","suffix","events","listener","NotificationPoller","clientExtensions","extensions","prototype","makeBucket","listBuckets","bucketExists","removeBucket","getObject","fGetObject","putObject","fPutObject","copyObject","removeObject","removeObjects","presignedGetObject","presignedPutObject","presignedPostPolicy","getBucketNotification","removeAllBucketNotification","getBucketPolicy","setBucketPolicy","removeIncompleteUpload","toUTCString","InvalidDateError","toISOString","type","min","max"],"mappings":"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","sourcesContent":["/*\n * MinIO Javascript Library for Amazon S3 Compatible Cloud Storage, (C) 2015 MinIO, Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport fs from 'fs'\nimport Crypto from 'crypto'\nimport Http from 'http'\nimport Https from 'https'\nimport Stream from 'stream'\nimport BlockStream2 from 'block-stream2'\nimport Xml from 'xml'\nimport xml2js from 'xml2js'\nimport async from 'async'\nimport querystring from 'querystring'\nimport mkdirp from 'mkdirp'\nimport path from 'path'\nimport _ from 'lodash'\nimport util from 'util'\n\nimport { extractMetadata, prependXAMZMeta, isValidPrefix, isValidEndpoint, isValidBucketName,\n  isValidPort, isValidObjectName, isAmazonEndpoint, getScope,\n  uriEscape, uriResourceEscape, isBoolean, isFunction, isNumber,\n  isString, isObject, isArray, isValidDate, pipesetup,\n  readableStream, isReadableStream, isVirtualHostStyle,\n  insertContentType, makeDateLong, promisify } from './helpers.js'\n\nimport { signV4, presignSignatureV4, postPresignSignatureV4 } from './signing.js'\n\nimport ObjectUploader from './object-uploader'\n\nimport * as transformers from './transformers'\n\nimport * as errors from './errors.js'\n\nimport { getS3Endpoint } from './s3-endpoints.js'\n\nimport { NotificationConfig, NotificationPoller } from './notification'\n\nimport extensions from './extensions'\n\nvar Package = require('../../package.json')\n\nexport class Client {\n  constructor(params) {\n    if (typeof params.secure !== 'undefined') throw new Error('\"secure\" option deprecated, \"useSSL\" should be used instead')\n    // Default values if not specified.\n    if (typeof params.useSSL === 'undefined') params.useSSL = true\n    if (!params.port) params.port = 0\n    // Validate input params.\n    if (!isValidEndpoint(params.endPoint)) {\n      throw new errors.InvalidEndpointError(`Invalid endPoint : ${params.endPoint}`)\n    }\n    if (!isValidPort(params.port)) {\n      throw new errors.InvalidArgumentError(`Invalid port : ${params.port}`)\n    }\n    if (!isBoolean(params.useSSL)) {\n      throw new errors.InvalidArgumentError(`Invalid useSSL flag type : ${params.useSSL}, expected to be of type \"boolean\"`)\n    }\n\n    // Validate region only if its set.\n    if (params.region) {\n      if (!isString(params.region)) {\n        throw new errors.InvalidArgumentError(`Invalid region : ${params.region}`)\n      }\n    }\n\n    var host = params.endPoint.toLowerCase()\n    var port = params.port\n    var protocol = ''\n    var transport\n    // Validate if configuration is not using SSL\n    // for constructing relevant endpoints.\n    if (params.useSSL === false) {\n      transport = Http\n      protocol = 'http:'\n      if (port === 0) {\n        port = 80\n      }\n    } else {\n      // Defaults to secure.\n      transport = Https\n      protocol = 'https:'\n      if (port === 0) {\n        port = 443\n      }\n    }\n\n    // if custom transport is set, use it.\n    if (params.transport) {\n      if (!isObject(params.transport)) {\n        throw new errors.InvalidArgumentError('Invalid transport type : ${params.transport}, expected to be type \"object\"')\n      }\n      transport = params.transport\n    }\n\n    // User Agent should always following the below style.\n    // Please open an issue to discuss any new changes here.\n    //\n    //       MinIO (OS; ARCH) LIB/VER APP/VER\n    //\n    var libraryComments = `(${process.platform}; ${process.arch})`\n    var libraryAgent = `MinIO ${libraryComments} minio-js/${Package.version}`\n    // User agent block ends.\n\n    this.transport = transport\n    this.host = host\n    this.port = port\n    this.dnsLookup = !!params.dnsLookup\n    this.protocol = protocol\n    this.accessKey = params.accessKey\n    this.secretKey = params.secretKey\n    this.sessionToken = params.sessionToken\n    this.userAgent = `${libraryAgent}`\n\n    if (!this.accessKey) this.accessKey = ''\n    if (!this.secretKey) this.secretKey = ''\n    this.anonymous = !this.accessKey || !this.secretKey\n\n    this.regionMap = {}\n    if (params.region) {\n      this.region = params.region\n    }\n\n    this.partSize = 64*1024*1024\n    if (params.partSize) {\n      this.partSize = params.partSize\n      this.overRidePartSize = true\n    }\n    if (this.partSize < 5*1024*1024) {\n      throw new errors.InvalidArgumentError(`Part size should be greater than 5MB`)\n    }\n    if (this.partSize > 5*1024*1024*1024) {\n      throw new errors.InvalidArgumentError(`Part size should be less than 5GB`)\n    }\n\n    this.maximumPartSize = 5*1024*1024*1024\n    this.maxObjectSize = 5*1024*1024*1024*1024\n    // SHA256 is enabled only for authenticated http requests. If the request is authenticated\n    // and the connection is https we use x-amz-content-sha256=UNSIGNED-PAYLOAD\n    // header for signature calculation.\n    this.enableSHA256 = !this.anonymous && !params.useSSL\n\n    this.reqOptions = {}\n  }\n\n  // Sets the supported request options.\n  setRequestOptions(options) {\n    if (!isObject(options)) {\n      throw new TypeError('request options should be of type \"object\"')\n    }\n    this.reqOptions = _.pick(options, ['agent', 'ca', 'cert', 'ciphers', 'clientCertEngine', 'crl', 'dhparam', 'ecdhCurve', 'family', 'honorCipherOrder', 'key', 'passphrase', 'pfx', 'rejectUnauthorized', 'secureOptions', 'secureProtocol', 'servername', 'sessionIdContext'])\n  }\n\n  // returns *options* object that can be used with http.request()\n  // Takes care of constructing virtual-host-style or path-style hostname\n  getRequestOptions(opts) {\n    var method = opts.method\n    var region = opts.region\n    var bucketName = opts.bucketName\n    var objectName = opts.objectName\n    var headers = opts.headers\n    var query = opts.query\n\n    var reqOptions = {method}\n    reqOptions.headers = {}\n\n    // Verify if virtual host supported.\n    var virtualHostStyle\n    if (bucketName) {\n      virtualHostStyle = this.dnsLookup       //isVirtualHostStyle(this.host,  this.protocol,    bucketName)\n    }\n\n    if (this.port) reqOptions.port = this.port\n    reqOptions.protocol = this.protocol\n\n    if (objectName) {\n      objectName = `${uriResourceEscape(objectName)}`\n    }\n\n    reqOptions.path = '/'\n\n    // Save host.\n    reqOptions.host = this.host\n    // For Amazon S3 endpoint, get endpoint based on region.\n    if (isAmazonEndpoint(reqOptions.host)) {\n      reqOptions.host = getS3Endpoint(region)\n    }\n\n    if (virtualHostStyle && !opts.pathStyle) {\n      // For all hosts which support virtual host style, `bucketName`\n      // is part of the hostname in the following format:\n      //\n      //  var host = 'bucketName.example.com'\n      //\n      if (bucketName) reqOptions.host = `${bucketName}.${reqOptions.host}`\n      if (objectName) reqOptions.path = `/${objectName}`\n    } else {\n      // For all S3 compatible storage services we will fallback to\n      // path style requests, where `bucketName` is part of the URI\n      // path.\n      if (bucketName) reqOptions.path = `/${bucketName}`\n      if (objectName) reqOptions.path = `/${bucketName}/${objectName}`\n    }\n\n    if (query) reqOptions.path += `?${query}`\n    reqOptions.headers.host = reqOptions.host\n    if ((reqOptions.protocol === 'http:' && reqOptions.port !== 80) ||\n        (reqOptions.protocol === 'https:' && reqOptions.port !== 443)) {\n      reqOptions.headers.host = `${reqOptions.host}:${reqOptions.port}`\n    }\n    reqOptions.headers['user-agent'] = this.userAgent\n    if (headers) {\n      // have all header keys in lower case - to make signing easy\n      _.map(headers, (v, k) => reqOptions.headers[k.toLowerCase()] = v)\n    }\n\n    // Use any request option specified in minioClient.setRequestOptions()\n    reqOptions = Object.assign({}, this.reqOptions, reqOptions)\n\n    return reqOptions\n  }\n\n  // Set application specific information.\n  //\n  // Generates User-Agent in the following style.\n  //\n  //       MinIO (OS; ARCH) LIB/VER APP/VER\n  //\n  // __Arguments__\n  // * `appName` _string_ - Application name.\n  // * `appVersion` _string_ - Application version.\n  setAppInfo(appName, appVersion) {\n    if (!isString(appName)) {\n      throw new TypeError(`Invalid appName: ${appName}`)\n    }\n    if (appName.trim() === '') {\n      throw new errors.InvalidArgumentError('Input appName cannot be empty.')\n    }\n    if (!isString(appVersion)) {\n      throw new TypeError(`Invalid appVersion: ${appVersion}`)\n    }\n    if (appVersion.trim() === '') {\n      throw new errors.InvalidArgumentError('Input appVersion cannot be empty.')\n    }\n    this.userAgent = `${this.userAgent} ${appName}/${appVersion}`\n  }\n\n  // Calculate part size given the object size. Part size will be atleast this.partSize\n  calculatePartSize(size) {\n    if (!isNumber(size)) {\n      throw new TypeError('size should be of type \"number\"')\n    }\n    if (size > this.maxObjectSize) {\n      throw new TypeError(`size should not be more than ${this.maxObjectSize}`)\n    }\n    if (this.overRidePartSize) {\n      return this.partSize\n    }\n    var partSize = this.partSize\n    for (;;) { \t\t\t// while(true) {...} throws linting error.\n      // If partSize is big enough to accomodate the object size, then use it.\n      if ((partSize * 10000) > size) {\n        return partSize\n      }\n      // Try part sizes as 64MB, 80MB, 96MB etc.\n      partSize += 16*1024*1024\n    }\n  }\n\n  // log the request, response, error\n  logHTTP(reqOptions, response, err) {\n    // if no logstreamer available return.\n    if (!this.logStream) return\n    if (!isObject(reqOptions)) {\n      throw new TypeError('reqOptions should be of type \"object\"')\n    }\n    if (response && !isReadableStream(response)) {\n      throw new TypeError('response should be of type \"Stream\"')\n    }\n    if (err && !(err instanceof Error)) {\n      throw new TypeError('err should be of type \"Error\"')\n    }\n    var logHeaders = (headers) => {\n      _.forEach(headers, (v, k) => {\n        if (k == 'authorization') {\n          var redacter = new RegExp('Signature=([0-9a-f]+)')\n          v = v.replace(redacter, 'Signature=**REDACTED**')\n        }\n        this.logStream.write(`${k}: ${v}\\n`)\n      })\n      this.logStream.write('\\n')\n    }\n    this.logStream.write(`REQUEST: ${reqOptions.method} ${reqOptions.path}\\n`)\n    logHeaders(reqOptions.headers)\n    if (response) {\n      this.logStream.write(`RESPONSE: ${response.statusCode}\\n`)\n      logHeaders(response.headers)\n    }\n    if (err) {\n      this.logStream.write('ERROR BODY:\\n')\n      var errJSON = JSON.stringify(err, null, '\\t')\n      this.logStream.write(`${errJSON}\\n`)\n    }\n  }\n\n  // Enable tracing\n  traceOn(stream) {\n    if (!stream) stream = process.stdout\n    this.logStream = stream\n  }\n\n  // Disable tracing\n  traceOff() {\n    this.logStream = null\n  }\n\n  // makeRequest is the primitive used by the apis for making S3 requests.\n  // payload can be empty string in case of no payload.\n  // statusCode is the expected statusCode. If response.statusCode does not match\n  // we parse the XML error and call the callback with the error message.\n  // A valid region is passed by the calls - listBuckets, makeBucket and\n  // getBucketRegion.\n  makeRequest(options, payload, statusCode, region, returnResponse, cb) {\n    if (!isObject(options)) {\n      throw new TypeError('options should be of type \"object\"')\n    }\n    if (!isString(payload) && !isObject(payload)) {\n      // Buffer is of type 'object'\n      throw new TypeError('payload should be of type \"string\" or \"Buffer\"')\n    }\n    if (!isNumber(statusCode)) {\n      throw new TypeError('statusCode should be of type \"number\"')\n    }\n    if (!isString(region)) {\n      throw new TypeError('region should be of type \"string\"')\n    }\n    if (!isBoolean(returnResponse)) {\n      throw new TypeError('returnResponse should be of type \"boolean\"')\n    }\n    if(!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n    if (!options.headers) options.headers = {}\n    if (options.method === 'POST' || options.method === 'PUT' || options.method === 'DELETE') {\n      options.headers['content-length'] = payload.length\n    }\n    var sha256sum = ''\n    if (this.enableSHA256) sha256sum = Crypto.createHash('sha256').update(payload).digest('hex')\n    var stream = readableStream(payload)\n    this.makeRequestStream(options, stream, sha256sum, statusCode, region, returnResponse, cb)\n  }\n\n  // makeRequestStream will be used directly instead of makeRequest in case the payload\n  // is available as a stream. for ex. putObject\n  makeRequestStream(options, stream, sha256sum, statusCode, region, returnResponse, cb) {\n    if (!isObject(options)) {\n      throw new TypeError('options should be of type \"object\"')\n    }\n    if (!isReadableStream(stream)) {\n      throw new errors.InvalidArgumentError('stream should be a readable Stream')\n    }\n    if (!isString(sha256sum)) {\n      throw new TypeError('sha256sum should be of type \"string\"')\n    }\n    if (!isNumber(statusCode)) {\n      throw new TypeError('statusCode should be of type \"number\"')\n    }\n    if (!isString(region)) {\n      throw new TypeError('region should be of type \"string\"')\n    }\n    if (!isBoolean(returnResponse)) {\n      throw new TypeError('returnResponse should be of type \"boolean\"')\n    }\n    if(!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n\n    // sha256sum will be empty for anonymous or https requests\n    if (!this.enableSHA256 && sha256sum.length !== 0) {\n      throw new errors.InvalidArgumentError(`sha256sum expected to be empty for anonymous or https requests`)\n    }\n    // sha256sum should be valid for non-anonymous http requests.\n    if (this.enableSHA256 && sha256sum.length !== 64) {\n      throw new errors.InvalidArgumentError(`Invalid sha256sum : ${sha256sum}`)\n    }\n\n    var _makeRequest = (e, region) => {\n      if (e) return cb(e)\n      options.region = region\n      var reqOptions = this.getRequestOptions(options)\n      if (!this.anonymous) {\n        // For non-anonymous https requests sha256sum is 'UNSIGNED-PAYLOAD' for signature calculation.\n        if (!this.enableSHA256) sha256sum = 'UNSIGNED-PAYLOAD'\n\n        let date = new Date()\n\n        reqOptions.headers['x-amz-date'] = makeDateLong(date)\n        reqOptions.headers['x-amz-content-sha256'] = sha256sum\n        if (this.sessionToken) {\n          reqOptions.headers['x-amz-security-token'] = this.sessionToken\n        }\n\n        var authorization = signV4(reqOptions, this.accessKey, this.secretKey, region, date)\n        reqOptions.headers.authorization = authorization\n      }\n      var req = this.transport.request(reqOptions, response => {\n        if (statusCode !== response.statusCode) {\n          // For an incorrect region, S3 server always sends back 400.\n          // But we will do cache invalidation for all errors so that,\n          // in future, if AWS S3 decides to send a different status code or\n          // XML error code we will still work fine.\n          delete(this.regionMap[options.bucketName])\n          var errorTransformer = transformers.getErrorTransformer(response)\n          pipesetup(response, errorTransformer)\n            .on('error', e => {\n              this.logHTTP(reqOptions, response, e)\n              cb(e)\n            })\n          return\n        }\n        this.logHTTP(reqOptions, response)\n        if (returnResponse) return cb(null, response)\n        // We drain the socket so that the connection gets closed. Note that this\n        // is not expensive as the socket will not have any data.\n        response.on('data', ()=>{})\n        cb(null)\n      })\n      let pipe = pipesetup(stream, req)\n      pipe.on('error', e => {\n        this.logHTTP(reqOptions, null, e)\n        cb(e)\n      })\n    }\n    if (region) return _makeRequest(null, region)\n    this.getBucketRegion(options.bucketName, _makeRequest)\n  }\n\n  // gets the region of the bucket\n  getBucketRegion(bucketName, cb) {\n      // cb(null,\"oss-cn-beijing\")\n      // return;\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError(`Invalid bucket name : ${bucketName}`)\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('cb should be of type \"function\"')\n    }\n\n    // Region is set with constructor, return the region right here.\n    if (this.region) return cb(null, this.region)\n\n    if (this.regionMap[bucketName]) return cb(null, this.regionMap[bucketName])\n    var extractRegion = (response) => {\n      var transformer = transformers.getBucketRegionTransformer()\n      var region = 'oss-cn-beijing'\n      pipesetup(response, transformer)\n        .on('error', cb)\n        .on('data', data => {\n          if (data) region = data\n        })\n        .on('end', () => {\n          this.regionMap[bucketName] = region\n          cb(null, region)\n        })\n    }\n\n    var method = 'GET'\n    var query = 'location'\n\n    // `getBucketLocation` behaves differently in following ways for\n    // different environments.\n    //\n    // - For nodejs env we default to path style requests.\n    // - For browser env path style requests on buckets yields CORS\n    //   error. To circumvent this problem we make a virtual host\n    //   style request signed with 'us-east-1'. This request fails\n    //   with an error 'AuthorizationHeaderMalformed', additionally\n    //   the error XML also provides Region of the bucket. To validate\n    //   this region is proper we retry the same request with the newly\n    //   obtained region.\n    var pathStyle = typeof window === 'undefined'\n    this.makeRequest({method, bucketName, query, pathStyle}, '', 200, 'oss-cn-beijing', true, (e, response) => {\n      if (e) {\n        if (e.name === 'AuthorizationHeaderMalformed') {\n          var region = e.Region\n          if (!region) return cb(e)\n          this.makeRequest({method, bucketName, query}, '', 200, region, true, (e, response) => {\n            if (e) return cb(e)\n            extractRegion(response)\n          })\n          return\n        }\n        return cb(e)\n      }\n      extractRegion(response)\n    })\n  }\n\n  // Creates the bucket `bucketName`.\n  //\n  // __Arguments__\n  // * `bucketName` _string_ - Name of the bucket\n  // * `region` _string_ - region valid values are _us-west-1_, _us-west-2_,  _eu-west-1_, _eu-central-1_, _ap-southeast-1_, _ap-northeast-1_, _ap-southeast-2_, _sa-east-1_.\n  // * `callback(err)` _function_ - callback function with `err` as the error argument. `err` is null if the bucket is successfully created.\n  makeBucket(bucketName, region, cb) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n\n    if (isFunction(region)) {\n      cb = region\n      region = ''\n    }\n\n    if (!isString(region)) {\n      throw new TypeError('region should be of type \"string\"')\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n\n    var payload = ''\n\n    // Region already set in constructor, validate if\n    // caller requested bucket location is same.\n    if (region && this.region) {\n      if (region !== this.region) {\n        throw new errors.InvalidArgumentError(`Configured region ${this.region}, requested ${region}`)\n      }\n    }\n\n    // sending makeBucket request with XML containing 'us-east-1' fails. For\n    // default region server expects the request without body\n    if (region && region !== 'us-east-1') {\n      var createBucketConfiguration = []\n      createBucketConfiguration.push({\n        _attr: {\n          xmlns: 'http://s3.amazonaws.com/doc/2006-03-01/'\n        }\n      })\n      createBucketConfiguration.push({\n        LocationConstraint: region\n      })\n      var payloadObject = {\n        CreateBucketConfiguration: createBucketConfiguration\n      }\n      payload = Xml(payloadObject)\n    }\n    var method = 'PUT'\n    var headers = {}\n    if (!region) region = 'us-east-1'\n    this.makeRequest({method, bucketName, headers}, payload, 200, region, false, cb)\n  }\n\n  // List of buckets created.\n  //\n  // __Arguments__\n  // * `callback(err, buckets)` _function_ - callback function with error as the first argument. `buckets` is an array of bucket information\n  //\n  // `buckets` array element:\n  // * `bucket.name` _string_ : bucket name\n  // * `bucket.creationDate` _Date_: date when bucket was created\n  listBuckets(cb) {\n    if (!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n    var method = 'GET'\n    this.makeRequest({method}, '', 200, 'us-east-1', true, (e, response) => {\n      if (e) return cb(e)\n      var transformer = transformers.getListBucketTransformer()\n      var buckets\n      pipesetup(response, transformer)\n        .on('data', result => buckets = result)\n        .on('error', e => cb(e))\n        .on('end', () => cb(null, buckets))\n    })\n  }\n\n  // Returns a stream that emits objects that are partially uploaded.\n  //\n  // __Arguments__\n  // * `bucketname` _string_: name of the bucket\n  // * `prefix` _string_: prefix of the object names that are partially uploaded (optional, default `''`)\n  // * `recursive` _bool_: directory style listing when false, recursive listing when true (optional, default `false`)\n  //\n  // __Return Value__\n  // * `stream` _Stream_ : emits objects of the format:\n  //   * `object.key` _string_: name of the object\n  //   * `object.uploadId` _string_: upload ID of the object\n  //   * `object.size` _Integer_: size of the partially uploaded object\n  listIncompleteUploads(bucket, prefix, recursive) {\n    if (prefix === undefined) prefix = ''\n    if (recursive === undefined) recursive = false\n    if (!isValidBucketName(bucket)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucket)\n    }\n    if (!isValidPrefix(prefix)) {\n      throw new errors.InvalidPrefixError(`Invalid prefix : ${prefix}`)\n    }\n    if (!isBoolean(recursive)) {\n      throw new TypeError('recursive should be of type \"boolean\"')\n    }\n    var delimiter = recursive ? '' : '/'\n    var keyMarker = ''\n    var uploadIdMarker = ''\n    var uploads = []\n    var ended = false\n    var readStream = Stream.Readable({objectMode: true})\n    readStream._read = () => {\n      // push one upload info per _read()\n      if (uploads.length) {\n        return readStream.push(uploads.shift())\n      }\n      if (ended) return readStream.push(null)\n      this.listIncompleteUploadsQuery(bucket, prefix, keyMarker, uploadIdMarker, delimiter)\n        .on('error', e => readStream.emit('error', e))\n        .on('data', result => {\n          result.prefixes.forEach(prefix => uploads.push(prefix))\n          async.eachSeries(result.uploads, (upload, cb) => {\n            // for each incomplete upload add the sizes of its uploaded parts\n            this.listParts(bucket, upload.key, upload.uploadId, (err, parts) => {\n              if (err) return cb(err)\n              upload.size = parts.reduce((acc, item) => acc + item.size, 0)\n              uploads.push(upload)\n              cb()\n            })\n          }, err => {\n            if (err) {\n              readStream.emit('error', err)\n              return\n            }\n            if (result.isTruncated) {\n              keyMarker = result.nextKeyMarker\n              uploadIdMarker = result.nextUploadIdMarker\n            } else {\n              ended = true\n            }\n            readStream._read()\n          })\n        })\n    }\n    return readStream\n  }\n\n  // To check if a bucket already exists.\n  //\n  // __Arguments__\n  // * `bucketName` _string_ : name of the bucket\n  // * `callback(err)` _function_ : `err` is `null` if the bucket exists\n  bucketExists(bucketName, cb) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n    var method = 'HEAD'\n    this.makeRequest({method, bucketName}, '', 200, '', false, err => {\n      if (err) {\n        if (err.code == 'NoSuchBucket' || err.code == 'NotFound') return cb(null, false)\n        return cb(err)\n      }\n      cb(null, true)\n    })\n  }\n\n  // Remove a bucket.\n  //\n  // __Arguments__\n  // * `bucketName` _string_ : name of the bucket\n  // * `callback(err)` _function_ : `err` is `null` if the bucket is removed successfully.\n  removeBucket(bucketName, cb) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n    var method = 'DELETE'\n    this.makeRequest({method, bucketName}, '', 204, '', false, (e) => {\n      // If the bucket was successfully removed, remove the region map entry.\n      if (!e) delete(this.regionMap[bucketName])\n      cb(e)\n    })\n  }\n\n  // Remove the partially uploaded object.\n  //\n  // __Arguments__\n  // * `bucketName` _string_: name of the bucket\n  // * `objectName` _string_: name of the object\n  // * `callback(err)` _function_: callback function is called with non `null` value in case of error\n  removeIncompleteUpload(bucketName, objectName, cb) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.isValidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError(`Invalid object name: ${objectName}`)\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n    var removeUploadId\n    async.during(\n      cb => {\n        this.findUploadId(bucketName, objectName, (e, uploadId) => {\n          if (e) return cb(e)\n          removeUploadId = uploadId\n          cb(null, uploadId)\n        })\n      },\n      cb => {\n        var method = 'DELETE'\n        var query = `uploadId=${removeUploadId}`\n        this.makeRequest({method, bucketName, objectName, query}, '', 204, '', false, e => cb(e))\n      },\n      cb\n    )\n  }\n\n  // Callback is called with `error` in case of error or `null` in case of success\n  //\n  // __Arguments__\n  // * `bucketName` _string_: name of the bucket\n  // * `objectName` _string_: name of the object\n  // * `filePath` _string_: path to which the object data will be written to\n  // * `callback(err)` _function_: callback is called with `err` in case of error.\n  fGetObject(bucketName, objectName, filePath, cb) {\n    // Input validation.\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError(`Invalid object name: ${objectName}`)\n    }\n    if (!isString(filePath)) {\n      throw new TypeError('filePath should be of type \"string\"')\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n\n    // Internal data.\n    var partFile\n    var partFileStream\n    var objStat\n\n    // Rename wrapper.\n    var rename = err => {\n      if (err) return cb(err)\n      fs.rename(partFile, filePath, cb)\n    }\n\n    async.waterfall([\n      cb => this.statObject(bucketName, objectName, cb),\n      (result, cb) => {\n        objStat = result\n        // Create any missing top level directories.\n        mkdirp(path.dirname(filePath), cb)\n      },\n      (ignore, cb) => {\n        partFile = `${filePath}.${objStat.etag}.part.minio`\n        fs.stat(partFile, (e, stats) => {\n          var offset = 0\n          if (e) {\n            partFileStream = fs.createWriteStream(partFile, {flags: 'w'})\n          } else {\n            if (objStat.size === stats.size) return rename()\n            offset = stats.size\n            partFileStream = fs.createWriteStream(partFile, {flags: 'a'})\n          }\n          this.getPartialObject(bucketName, objectName, offset, 0, cb)\n        })\n      },\n      (downloadStream, cb) => {\n        pipesetup(downloadStream, partFileStream)\n          .on('error', e => cb(e))\n          .on('finish', cb)\n      },\n      cb => fs.stat(partFile, cb),\n      (stats, cb) => {\n        if (stats.size === objStat.size) return cb()\n        cb(new Error('Size mismatch between downloaded file and the object'))\n      }\n    ], rename)\n  }\n\n  // Callback is called with readable stream of the object content.\n  //\n  // __Arguments__\n  // * `bucketName` _string_: name of the bucket\n  // * `objectName` _string_: name of the object\n  // * `callback(err, stream)` _function_: callback is called with `err` in case of error. `stream` is the object content stream\n  getObject(bucketName, objectName, cb) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError(`Invalid object name: ${objectName}`)\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n    this.getPartialObject(bucketName, objectName, 0, 0, cb)\n  }\n\n  // Callback is called with readable stream of the partial object content.\n  //\n  // __Arguments__\n  // * `bucketName` _string_: name of the bucket\n  // * `objectName` _string_: name of the object\n  // * `offset` _number_: offset of the object from where the stream will start\n  // * `length` _number_: length of the object that will be read in the stream (optional, if not specified we read the rest of the file from the offset)\n  // * `callback(err, stream)` _function_: callback is called with `err` in case of error. `stream` is the object content stream\n  getPartialObject(bucketName, objectName, offset, length, cb) {\n    if (isFunction(length)) {\n      cb = length\n      length = 0\n    }\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError(`Invalid object name: ${objectName}`)\n    }\n    if (!isNumber(offset)) {\n      throw new TypeError('offset should be of type \"number\"')\n    }\n    if (!isNumber(length)) {\n      throw new TypeError('length should be of type \"number\"')\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n\n    var range = ''\n    if (offset || length) {\n      if (offset) {\n        range = `bytes=${+offset}-`\n      } else {\n        range = 'bytes=0-'\n        offset = 0\n      }\n      if (length) {\n        range += `${(+length + offset) - 1}`\n      }\n    }\n\n    var headers = {}\n    if (range !== '') {\n      headers.range = range\n    }\n\n    var expectedStatus = 200\n    if (range) {\n      expectedStatus = 206\n    }\n    var method = 'GET'\n    this.makeRequest({method, bucketName, objectName, headers}, '', expectedStatus, '', true, cb)\n  }\n\n  // Uploads the object using contents from a file\n  //\n  // __Arguments__\n  // * `bucketName` _string_: name of the bucket\n  // * `objectName` _string_: name of the object\n  // * `filePath` _string_: file path of the file to be uploaded\n  // * `metaData` _Javascript Object_: metaData assosciated with the object\n  // * `callback(err, etag)` _function_: non null `err` indicates error, `etag` _string_ is the etag of the object uploaded.\n  fPutObject(bucketName, objectName, filePath, metaData, callback) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError(`Invalid object name: ${objectName}`)\n    }\n\n    if (!isString(filePath)) {\n      throw new TypeError('filePath should be of type \"string\"')\n    }\n    if (isFunction(metaData)) {\n      callback = metaData\n      metaData = {} // Set metaData empty if no metaData provided.\n    }\n    if (!isObject(metaData)) {\n      throw new TypeError('metaData should be of type \"object\"')\n    }\n\n    // Inserts correct `content-type` attribute based on metaData and filePath\n    metaData = insertContentType(metaData, filePath)\n\n    //Updates metaData to have the correct prefix if needed\n    metaData = prependXAMZMeta(metaData)\n    var size\n    var partSize\n\n    async.waterfall([\n      cb => fs.stat(filePath, cb),\n      (stats, cb) => {\n        size = stats.size\n        if (size > this.maxObjectSize) {\n          return cb(new Error(`${filePath} size : ${stats.size}, max allowed size : 5TB`))\n        }\n        if (size <= this.partSize) {\n          // simple PUT request, no multipart\n          var multipart = false\n          var uploader = this.getUploader(bucketName, objectName, metaData, multipart)\n          var hash = transformers.getHashSummer(this.enableSHA256)\n          var start = 0\n          var end = size - 1\n          var autoClose = true\n          if (size === 0) end = 0\n          var options = {start, end, autoClose}\n          pipesetup(fs.createReadStream(filePath, options), hash)\n            .on('data', data => {\n              var md5sum = data.md5sum\n              var sha256sum = data.sha256sum\n              var stream = fs.createReadStream(filePath, options)\n              uploader(stream, size, sha256sum, md5sum, (err, etag) => {\n                callback(err, etag)\n                cb(true)\n              })\n            })\n            .on('error', e => cb(e))\n          return\n        }\n        this.findUploadId(bucketName, objectName, cb)\n      },\n      (uploadId, cb) => {\n        // if there was a previous incomplete upload, fetch all its uploaded parts info\n        if (uploadId) return this.listParts(bucketName, objectName, uploadId,  (e, etags) =>  cb(e, uploadId, etags))\n        // there was no previous upload, initiate a new one\n        this.initiateNewMultipartUpload(bucketName, objectName, metaData, (e, uploadId) => cb(e, uploadId, []))\n      },\n      (uploadId, etags, cb) => {\n        partSize = this.calculatePartSize(size)\n        var multipart = true\n        var uploader = this.getUploader(bucketName, objectName, metaData, multipart)\n\n        // convert array to object to make things easy\n        var parts = etags.reduce(function(acc, item) {\n          if (!acc[item.part]) {\n            acc[item.part] = item\n          }\n          return acc\n        }, {})\n        var partsDone = []\n        var partNumber = 1\n        var uploadedSize = 0\n        async.whilst(\n          cb => { cb(null, uploadedSize < size) },\n          cb => {\n            var part = parts[partNumber]\n            var hash = transformers.getHashSummer(this.enableSHA256)\n            var length = partSize\n            if (length > (size - uploadedSize)) {\n              length = size - uploadedSize\n            }\n            var start = uploadedSize\n            var end = uploadedSize + length - 1\n            var autoClose = true\n            var options = {autoClose, start, end}\n            // verify md5sum of each part\n            pipesetup(fs.createReadStream(filePath, options), hash)\n              .on('data', data => {\n                var md5sumHex = (Buffer.from(data.md5sum, 'base64')).toString('hex')\n                if (part && (md5sumHex === part.etag)) {\n                  //md5 matches, chunk already uploaded\n                  partsDone.push({part: partNumber, etag: part.etag})\n                  partNumber++\n                  uploadedSize += length\n                  return cb()\n                }\n                // part is not uploaded yet, or md5 mismatch\n                var stream = fs.createReadStream(filePath, options)\n                uploader(uploadId, partNumber, stream, length,\n                         data.sha256sum, data.md5sum, (e, etag) => {\n                           if (e) return cb(e)\n                           partsDone.push({part: partNumber, etag})\n                           partNumber++\n                           uploadedSize += length\n                           return cb()\n                         })\n              })\n              .on('error', e => cb(e))\n          },\n          e => {\n            if (e) return cb(e)\n            cb(null, partsDone, uploadId)\n          }\n        )\n      },\n      // all parts uploaded, complete the multipart upload\n      (etags, uploadId, cb) => this.completeMultipartUpload(bucketName, objectName, uploadId, etags, cb)\n    ], (err, ...rest) => {\n      if (err === true) return\n      callback(err, ...rest)\n    })\n  }\n\n  // Uploads the object.\n  //\n  // Uploading a stream\n  // __Arguments__\n  // * `bucketName` _string_: name of the bucket\n  // * `objectName` _string_: name of the object\n  // * `stream` _Stream_: Readable stream\n  // * `size` _number_: size of the object (optional)\n  // * `callback(err, etag)` _function_: non null `err` indicates error, `etag` _string_ is the etag of the object uploaded.\n  //\n  // Uploading \"Buffer\" or \"string\"\n  // __Arguments__\n  // * `bucketName` _string_: name of the bucket\n  // * `objectName` _string_: name of the object\n  // * `string or Buffer` _string_ or _Buffer_: string or buffer\n  // * `callback(err, etag)` _function_: non null `err` indicates error, `etag` _string_ is the etag of the object uploaded.\n  putObject(bucketName, objectName, stream, size, metaData, callback) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError(`Invalid object name: ${objectName}`)\n    }\n\n    // We'll need to shift arguments to the left because of size and metaData.\n    if (isFunction(size)) {\n      callback = size\n      metaData = {}\n    } else if (isFunction(metaData)) {\n      callback = metaData\n      metaData = {}\n    }\n\n    // We'll need to shift arguments to the left because of metaData\n    // and size being optional.\n    if (isObject(size)) {\n      metaData = size\n    }\n\n    //Ensures Metadata has appropriate prefix for A3 API\n    metaData = prependXAMZMeta(metaData)\n    if (typeof stream === 'string' || stream instanceof Buffer) {\n      // Adapts the non-stream interface into a stream.\n      size = stream.length\n      stream = readableStream(stream)\n    } else if (!isReadableStream(stream)) {\n      throw new TypeError('third argument should be of type \"stream.Readable\" or \"Buffer\" or \"string\"')\n    }\n\n    if (!isFunction(callback)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n\n    if (isNumber(size) && size < 0) {\n      throw new errors.InvalidArgumentError(`size cannot be negative, given size: ${size}`)\n    }\n\n    // Get the part size and forward that to the BlockStream. Default to the\n    // largest block size possible if necessary.\n    if (!isNumber(size))\n      size = this.maxObjectSize\n\n    size = this.calculatePartSize(size)\n\n    // s3 requires that all non-end chunks be at least `this.partSize`,\n    // so we chunk the stream until we hit either that size or the end before\n    // we flush it to s3.\n    let chunker = new BlockStream2({size, zeroPadding: false})\n\n    // This is a Writable stream that can be written to in order to upload\n    // to the specified bucket and object automatically.\n    let uploader = new ObjectUploader(this, bucketName, objectName, size, metaData, callback)\n    // stream => chunker => uploader\n    stream.pipe(chunker).pipe(uploader)\n  }\n\n  // Copy the object.\n  //\n  // __Arguments__\n  // * `bucketName` _string_: name of the bucket\n  // * `objectName` _string_: name of the object\n  // * `srcObject` _string_: path of the source object to be copied\n  // * `conditions` _CopyConditions_: copy conditions that needs to be satisfied (optional, default `null`)\n  // * `callback(err, {etag, lastModified})` _function_: non null `err` indicates error, `etag` _string_ and `listModifed` _Date_ are respectively the etag and the last modified date of the newly copied object\n  copyObject(arg1, arg2, arg3, arg4, arg5) {\n    var bucketName = arg1\n    var objectName = arg2\n    var srcObject = arg3\n    var conditions, cb\n    if (typeof arg4 == 'function' && arg5 === undefined) {\n      conditions = null\n      cb = arg4\n    } else {\n      conditions = arg4\n      cb = arg5\n    }\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError(`Invalid object name: ${objectName}`)\n    }\n    if (!isString(srcObject)) {\n      throw new TypeError('srcObject should be of type \"string\"')\n    }\n    if (srcObject === \"\") {\n      throw new errors.InvalidPrefixError(`Empty source prefix`)\n    }\n\n    if (conditions !== null && !(conditions instanceof CopyConditions)) {\n      throw new TypeError('conditions should be of type \"CopyConditions\"')\n    }\n\n    var headers = {}\n    headers['x-amz-copy-source'] = uriEscape(srcObject)\n\n    if (conditions !== null) {\n      if (conditions.modified !== \"\") {\n        headers['x-amz-copy-source-if-modified-since'] = conditions.modified\n      }\n      if (conditions.unmodified !== \"\") {\n        headers['x-amz-copy-source-if-unmodified-since'] = conditions.unmodified\n      }\n      if (conditions.matchETag !== \"\") {\n        headers['x-amz-copy-source-if-match'] = conditions.matchETag\n      }\n      if (conditions.matchEtagExcept !== \"\") {\n        headers['x-amz-copy-source-if-none-match'] = conditions.matchETagExcept\n      }\n    }\n\n    var method = 'PUT'\n    this.makeRequest({method, bucketName, objectName, headers}, '', 200, '', true, (e, response) => {\n      if (e) return cb(e)\n      var transformer = transformers.getCopyObjectTransformer()\n      pipesetup(response, transformer)\n        .on('error', e => cb(e))\n        .on('data', data => cb(null, data))\n    })\n  }\n\n  // list a batch of objects\n  listObjectsQuery(bucketName, prefix, marker, delimiter, maxKeys) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isString(prefix)) {\n      throw new TypeError('prefix should be of type \"string\"')\n    }\n    if (!isString(marker)) {\n      throw new TypeError('marker should be of type \"string\"')\n    }\n    if (!isString(delimiter)) {\n      throw new TypeError('delimiter should be of type \"string\"')\n    }\n    if (!isNumber(maxKeys)) {\n      throw new TypeError('maxKeys should be of type \"number\"')\n    }\n\n    var queries = []\n    // escape every value in query string, except maxKeys\n    queries.push(`prefix=${uriEscape(prefix)}`)\n    queries.push(`delimiter=${uriEscape(delimiter)}`)\n\n    if (marker) {\n      marker = uriEscape(marker)\n      queries.push(`marker=${marker}`)\n    }\n\n    // no need to escape maxKeys\n    if (maxKeys) {\n      if (maxKeys >= 1000) {\n        maxKeys = 1000\n      }\n      queries.push(`max-keys=${maxKeys}`)\n    }\n    queries.sort()\n    var query = ''\n    if (queries.length > 0) {\n      query = `${queries.join('&')}`\n    }\n\n    var method = 'GET'\n    var transformer = transformers.getListObjectsTransformer()\n    this.makeRequest({method, bucketName, query}, '', 200, '', true, (e, response) => {\n      if (e) return transformer.emit('error', e)\n      pipesetup(response, transformer)\n    })\n    return transformer\n  }\n\n  // List the objects in the bucket.\n  //\n  // __Arguments__\n  // * `bucketName` _string_: name of the bucket\n  // * `prefix` _string_: the prefix of the objects that should be listed (optional, default `''`)\n  // * `recursive` _bool_: `true` indicates recursive style listing and `false` indicates directory style listing delimited by '/'. (optional, default `false`)\n  //\n  // __Return Value__\n  // * `stream` _Stream_: stream emitting the objects in the bucket, the object is of the format:\n  // * `obj.name` _string_: name of the object\n  // * `obj.prefix` _string_: name of the object prefix\n  // * `obj.size` _number_: size of the object\n  // * `obj.etag` _string_: etag of the object\n  // * `obj.lastModified` _Date_: modified time stamp\n  listObjects(bucketName, prefix, recursive) {\n    if (prefix === undefined) prefix = ''\n    if (recursive === undefined) recursive = false\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidPrefix(prefix)) {\n      throw new errors.InvalidPrefixError(`Invalid prefix : ${prefix}`)\n    }\n    if (!isString(prefix)) {\n      throw new TypeError('prefix should be of type \"string\"')\n    }\n    if (!isBoolean(recursive)) {\n      throw new TypeError('recursive should be of type \"boolean\"')\n    }\n    // if recursive is false set delimiter to '/'\n    var delimiter = recursive ? '' : '/'\n    var marker = ''\n    var objects = []\n    var ended = false\n    var readStream = Stream.Readable({objectMode: true})\n    readStream._read = () => {\n      // push one object per _read()\n      if (objects.length) {\n        readStream.push(objects.shift())\n        return\n      }\n      if (ended) return readStream.push(null)\n      // if there are no objects to push do query for the next batch of objects\n      this.listObjectsQuery(bucketName, prefix, marker, delimiter, 1000)\n        .on('error', e => readStream.emit('error', e))\n        .on('data', result => {\n          if (result.isTruncated) {\n            marker = result.nextMarker\n          } else {\n            ended = true\n          }\n          objects = result.objects\n          readStream._read()\n        })\n    }\n    return readStream\n  }\n\n  // listObjectsV2Query - (List Objects V2) - List some or all (up to 1000) of the objects in a bucket.\n  //\n  // You can use the request parameters as selection criteria to return a subset of the objects in a bucket.\n  // request parameters :-\n  // * `bucketName` _string_: name of the bucket\n  // * `prefix` _string_: Limits the response to keys that begin with the specified prefix.\n  // * `continuation-token` _string_: Used to continue iterating over a set of objects.\n  // * `delimiter` _string_: A delimiter is a character you use to group keys.\n  // * `max-keys` _number_: Sets the maximum number of keys returned in the response body.\n  // * `start-after` _string_: Specifies the key to start after when listing objects in a bucket.\n  listObjectsV2Query(bucketName, prefix, continuationToken, delimiter, maxKeys, startAfter) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isString(prefix)) {\n      throw new TypeError('prefix should be of type \"string\"')\n    }\n    if (!isString(continuationToken)) {\n      throw new TypeError('continuationToken should be of type \"string\"')\n    }\n    if (!isString(delimiter)) {\n      throw new TypeError('delimiter should be of type \"string\"')\n    }\n    if (!isNumber(maxKeys)) {\n      throw new TypeError('maxKeys should be of type \"number\"')\n    }\n    if (!isString(startAfter)) {\n      throw new TypeError('startAfter should be of type \"string\"')\n    }\n    var queries = []\n\n    // Call for listing objects v2 API\n    queries.push(`list-type=2`)\n\n    // escape every value in query string, except maxKeys\n    queries.push(`prefix=${uriEscape(prefix)}`)\n    queries.push(`delimiter=${uriEscape(delimiter)}`)\n\n    if (continuationToken) {\n      continuationToken = uriEscape(continuationToken)\n      queries.push(`continuation-token=${continuationToken}`)\n    }\n    // Set start-after\n    if (startAfter) {\n      startAfter = uriEscape(startAfter)\n      queries.push(`start-after=${startAfter}`)\n    }\n    // no need to escape maxKeys\n    if (maxKeys) {\n      if (maxKeys >= 1000) {\n        maxKeys = 1000\n      }\n      queries.push(`max-keys=${maxKeys}`)\n    }\n    queries.sort()\n    var query = ''\n    if (queries.length > 0) {\n      query = `${queries.join('&')}`\n    }\n    var method = 'GET'\n    var transformer = transformers.getListObjectsV2Transformer()\n    this.makeRequest({method, bucketName, query}, '', 200, '', true, (e, response) => {\n      if (e) return transformer.emit('error', e)\n      pipesetup(response, transformer)\n    })\n    return transformer\n  }\n\n  // List the objects in the bucket using S3 ListObjects V2\n  //\n  // __Arguments__\n  // * `bucketName` _string_: name of the bucket\n  // * `prefix` _string_: the prefix of the objects that should be listed (optional, default `''`)\n  // * `recursive` _bool_: `true` indicates recursive style listing and `false` indicates directory style listing delimited by '/'. (optional, default `false`)\n  // * `startAfter` _string_: Specifies the key to start after when listing objects in a bucket. (optional, default `''`)\n  //\n  // __Return Value__\n  // * `stream` _Stream_: stream emitting the objects in the bucket, the object is of the format:\n  //   * `obj.name` _string_: name of the object\n  //   * `obj.prefix` _string_: name of the object prefix\n  //   * `obj.size` _number_: size of the object\n  //   * `obj.etag` _string_: etag of the object\n  //   * `obj.lastModified` _Date_: modified time stamp\n  listObjectsV2(bucketName, prefix, recursive, startAfter) {\n    if (prefix === undefined) prefix = ''\n    if (recursive === undefined) recursive = false\n    if (startAfter === undefined) startAfter = ''\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidPrefix(prefix)) {\n      throw new errors.InvalidPrefixError(`Invalid prefix : ${prefix}`)\n    }\n    if (!isString(prefix)) {\n      throw new TypeError('prefix should be of type \"string\"')\n    }\n    if (!isBoolean(recursive)) {\n      throw new TypeError('recursive should be of type \"boolean\"')\n    }\n    if (!isString(startAfter)) {\n      throw new TypeError('startAfter should be of type \"string\"')\n    }\n    // if recursive is false set delimiter to '/'\n    var delimiter = recursive ? '' : '/'\n    var continuationToken = ''\n    var objects = []\n    var ended = false\n    var readStream = Stream.Readable({objectMode: true})\n    readStream._read = () => {\n      // push one object per _read()\n      if (objects.length) {\n        readStream.push(objects.shift())\n        return\n      }\n      if (ended) return readStream.push(null)\n      // if there are no objects to push do query for the next batch of objects\n      this.listObjectsV2Query(bucketName, prefix, continuationToken, delimiter, 1000, startAfter)\n        .on('error', e => readStream.emit('error', e))\n        .on('data', result => {\n          if (result.isTruncated) {\n            continuationToken = result.nextContinuationToken\n          } else {\n            ended = true\n          }\n          objects = result.objects\n          readStream._read()\n        })\n    }\n    return readStream\n  }\n\n  // Stat information of the object.\n  //\n  // __Arguments__\n  // * `bucketName` _string_: name of the bucket\n  // * `objectName` _string_: name of the object\n  // * `callback(err, stat)` _function_: `err` is not `null` in case of error, `stat` contains the object information:\n  //   * `stat.size` _number_: size of the object\n  //   * `stat.etag` _string_: etag of the object\n  //   * `stat.metaData` _string_: MetaData of the object\n  //   * `stat.lastModified` _Date_: modified time stamp\n  statObject(bucketName, objectName, cb) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError(`Invalid object name: ${objectName}`)\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n\n    var method = 'HEAD'\n    this.makeRequest({method, bucketName, objectName}, '', 200, '', true, (e, response) => {\n      if (e) return cb(e)\n\n      // We drain the socket so that the connection gets closed. Note that this\n      // is not expensive as the socket will not have any data.\n      response.on('data', ()=>{})\n\n      var result = {\n        size: +response.headers['content-length'],\n        metaData: extractMetadata(response.headers),\n        lastModified: new Date(response.headers['last-modified'])\n      }\n      var etag = response.headers.etag\n      if (etag) {\n        etag = etag.replace(/^\"/, '').replace(/\"$/, '')\n        result.etag = etag\n      }\n      cb(null, result)\n    })\n  }\n\n  // Remove the specified object.\n  //\n  // __Arguments__\n  // * `bucketName` _string_: name of the bucket\n  // * `objectName` _string_: name of the object\n  // * `callback(err)` _function_: callback function is called with non `null` value in case of error\n  removeObject(bucketName, objectName, cb) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError(`Invalid object name: ${objectName}`)\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n    var method = 'DELETE'\n    this.makeRequest({method, bucketName, objectName}, '', 204, '', false, cb)\n  }\n\n  // Remove all the objects residing in the objectsList.\n  //\n  // __Arguments__\n  // * `bucketName` _string_: name of the bucket\n  // * `objectsList` _array_: array of objects\n  removeObjects(bucketName, objectsList, cb) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isArray(objectsList)) {\n      throw new errors.InvalidArgumentError('objectsList should be a list')\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n\n    const maxEntries = 1000\n    const query = 'delete'\n    const method = 'POST'\n\n    let result = objectsList.reduce((result, entry) => {\n      result.list.push(entry)\n      if (result.list.length === maxEntries) {\n        result.listOfList.push(result.list)\n        result.list = []\n      }\n      return result\n    }, {listOfList: [], list:[]})\n\n    if (result.list.length > 0) {\n      result.listOfList.push(result.list)\n    }\n    \n    const encoder = new util.TextEncoder()\n\n    async.eachSeries(result.listOfList, (list, callback) => {\n      var deleteObjects={\"Delete\":[{\"Quiet\": true}]}\n\n      list.forEach(function(value){\n        deleteObjects[\"Delete\"].push({\"Object\": [{\"Key\": value}]})\n      })\n\n      let payload = Xml(deleteObjects)\n      payload = encoder.encode(payload)\n\n      var headers = {}\n      var md5digest = Crypto.createHash('md5').update(payload).digest()\n\n      headers['Content-MD5'] = md5digest.toString('base64')\n\n      this.makeRequest({ method, bucketName, query, headers}, payload, 200, '', false, (e) => {\n        if (e) return callback(e)\n        callback(null)\n      })\n    }, cb)\n  }\n\n\n  // Get the policy on a bucket or an object prefix.\n  //\n  // __Arguments__\n  // * `bucketName` _string_: name of the bucket\n  // * `callback(err, policy)` _function_: callback function\n  getBucketPolicy(bucketName, cb) {\n    // Validate arguments.\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError(`Invalid bucket name: ${bucketName}`)\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n\n    let method = 'GET'\n    let query = 'policy'\n    this.makeRequest({method, bucketName, query}, '', 200, '', true, (e, response) => {\n      if (e) return cb(e)\n\n      let policy = Buffer.from('')\n      pipesetup(response, transformers.getConcater())\n        .on('data', data => policy = data)\n        .on('error', cb)\n        .on('end', () => {\n          cb(null, policy.toString())\n        })\n    })\n  }\n\n  // Set the policy on a bucket or an object prefix.\n  //\n  // __Arguments__\n  // * `bucketName` _string_: name of the bucket\n  // * `bucketPolicy` _string_: bucket policy (JSON stringify'ed)\n  // * `callback(err)` _function_: callback function\n  setBucketPolicy(bucketName, policy, cb) {\n    // Validate arguments.\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError(`Invalid bucket name: ${bucketName}`)\n    }\n    if (!isString(policy)) {\n      throw new errors.InvalidBucketPolicyError(`Invalid bucket policy: ${policy} - must be \"string\"`)\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n\n    let method = 'DELETE'\n    let query = 'policy'\n\n    if (policy) {\n      method = 'PUT'\n    }\n\n    this.makeRequest({method, bucketName, query}, policy, 204, '', false, cb)\n  }\n\n  // Generate a generic presigned URL which can be\n  // used for HTTP methods GET, PUT, HEAD and DELETE\n  //\n  // __Arguments__\n  // * `method` _string_: name of the HTTP method\n  // * `bucketName` _string_: name of the bucket\n  // * `objectName` _string_: name of the object\n  // * `expiry` _number_: expiry in seconds (optional, default 7 days)\n  // * `reqParams` _object_: request parameters (optional)\n  // * `requestDate` _Date_: A date object, the url will be issued at (optional)\n  presignedUrl(method, bucketName, objectName, expires, reqParams, requestDate, cb) {\n    if (this.anonymous) {\n      throw new errors.AnonymousRequestError('Presigned ' + method + ' url cannot be generated for anonymous requests')\n    }\n    if (isFunction(requestDate)) {\n      cb = requestDate\n      requestDate = new Date()\n    }\n    if (isFunction(reqParams)) {\n      cb = reqParams\n      reqParams = {}\n      requestDate = new Date()\n    }\n    if (isFunction(expires)) {\n      cb = expires\n      reqParams = {}\n      expires = 24 * 60 * 60 * 7 // 7 days in seconds\n      requestDate = new Date()\n    }\n    if (!isNumber(expires)) {\n      throw new TypeError('expires should be of type \"number\"')\n    }\n    if (!isObject(reqParams)) {\n      throw new TypeError('reqParams should be of type \"object\"')\n    }\n    if (!isValidDate(requestDate)) {\n      throw new TypeError('requestDate should be of type \"Date\" and valid')\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n    var query = querystring.stringify(reqParams)\n    this.getBucketRegion(bucketName, (e, region) => {\n      if (e) return cb(e)\n      // This statement is added to ensure that we send error through\n      // callback on presign failure.\n      var url\n      var reqOptions = this.getRequestOptions({method,\n                                               region,\n                                               bucketName,\n                                               objectName,\n                                               query})\n      try {\n        url = presignSignatureV4(reqOptions, this.accessKey, this.secretKey,\n                                 this.sessionToken, region, requestDate, expires)\n      } catch (pe) {\n        return cb(pe)\n      }\n      cb(null, url)\n    })\n  }\n\n  // Generate a presigned URL for GET\n  //\n  // __Arguments__\n  // * `bucketName` _string_: name of the bucket\n  // * `objectName` _string_: name of the object\n  // * `expiry` _number_: expiry in seconds (optional, default 7 days)\n  // * `respHeaders` _object_: response headers to override (optional)\n  // * `requestDate` _Date_: A date object, the url will be issued at (optional)\n  presignedGetObject(bucketName, objectName, expires, respHeaders, requestDate, cb) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError(`Invalid object name: ${objectName}`)\n    }\n\n    if (isFunction(respHeaders)) {\n      cb = respHeaders\n      respHeaders = {}\n      requestDate = new Date()\n    }\n\n    var validRespHeaders = ['response-content-type', 'response-content-language', 'response-expires', 'response-cache-control',\n                            'response-content-disposition', 'response-content-encoding']\n    validRespHeaders.forEach(header => {\n      if  (respHeaders !== undefined && respHeaders[header] !== undefined && !isString(respHeaders[header])) {\n        throw new TypeError(`response header ${header} should be of type \"string\"`)\n      }\n    })\n    return this.presignedUrl('GET', bucketName, objectName, expires, respHeaders, requestDate, cb)\n  }\n\n  // Generate a presigned URL for PUT. Using this URL, the browser can upload to S3 only with the specified object name.\n  //\n  // __Arguments__\n  // * `bucketName` _string_: name of the bucket\n  // * `objectName` _string_: name of the object\n  // * `expiry` _number_: expiry in seconds (optional, default 7 days)\n  presignedPutObject(bucketName, objectName, expires, cb) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ${bucketName}')\n    }\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError('Invalid object name: ${objectName}')\n    }\n    return this.presignedUrl('PUT', bucketName, objectName, expires, cb)\n  }\n\n  // return PostPolicy object\n  newPostPolicy() {\n    return new PostPolicy()\n  }\n\n  // presignedPostPolicy can be used in situations where we want more control on the upload than what\n  // presignedPutObject() provides. i.e Using presignedPostPolicy we will be able to put policy restrictions\n  // on the object's `name` `bucket` `expiry` `Content-Type`\n  presignedPostPolicy(postPolicy, cb) {\n    if (this.anonymous) {\n      throw new errors.AnonymousRequestError('Presigned POST policy cannot be generated for anonymous requests')\n    }\n    if (!isObject(postPolicy)) {\n      throw new TypeError('postPolicy should be of type \"object\"')\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('cb should be of type \"function\"')\n    }\n    this.getBucketRegion(postPolicy.formData.bucket, (e, region) => {\n      if (e) return cb(e)\n      var date = new Date()\n      var dateStr = makeDateLong(date)\n\n      if (!postPolicy.policy.expiration) {\n        // 'expiration' is mandatory field for S3.\n        // Set default expiration date of 7 days.\n        var expires = new Date()\n        expires.setSeconds(24 * 60 * 60 * 7)\n        postPolicy.setExpires(expires)\n      }\n\n      postPolicy.policy.conditions.push(['eq', '$x-amz-date', dateStr])\n      postPolicy.formData['x-amz-date'] = dateStr\n\n      postPolicy.policy.conditions.push(['eq', '$x-amz-algorithm', 'AWS4-HMAC-SHA256'])\n      postPolicy.formData['x-amz-algorithm'] = 'AWS4-HMAC-SHA256'\n\n      postPolicy.policy.conditions.push([\"eq\", \"$x-amz-credential\", this.accessKey + \"/\" + getScope(region, date)])\n      postPolicy.formData['x-amz-credential'] = this.accessKey + \"/\" + getScope(region, date)\n\n      if (this.sessionToken) {\n        postPolicy.policy.conditions.push(['eq', '$x-amz-security-token', this.sessionToken])\n      }\n\n      var policyBase64 = Buffer.from(JSON.stringify(postPolicy.policy)).toString('base64')\n\n      postPolicy.formData.policy = policyBase64\n\n      var signature = postPresignSignatureV4(region, date, this.secretKey, policyBase64)\n\n      postPolicy.formData['x-amz-signature'] = signature\n      var opts = {}\n      opts.region = region\n      opts.bucketName = postPolicy.formData.bucket\n      var reqOptions = this.getRequestOptions(opts)\n      var portStr = (this.port == 80 || this.port === 443) ? '' : `:${this.port.toString()}`\n      var urlStr = `${reqOptions.protocol}//${reqOptions.host}${portStr}${reqOptions.path}`\n      cb(null, {postURL: urlStr,formData: postPolicy.formData})\n    })\n  }\n\n  // Calls implemented below are related to multipart.\n\n  // Initiate a new multipart upload.\n  initiateNewMultipartUpload(bucketName, objectName, metaData, cb) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError(`Invalid object name: ${objectName}`)\n    }\n    if (!isObject(metaData)) {\n      throw new errors.InvalidObjectNameError('contentType should be of type \"object\"')\n    }\n    var method = 'POST'\n    let headers = Object.assign({}, metaData)\n    var query = 'uploads'\n    this.makeRequest({method, bucketName, objectName, query, headers}, '', 200, '', true, (e, response) => {\n      if (e) return cb(e)\n      var transformer = transformers.getInitiateMultipartTransformer()\n      pipesetup(response, transformer)\n        .on('error', e => cb(e))\n        .on('data', uploadId => cb(null, uploadId))\n    })\n  }\n\n  // Complete the multipart upload. After all the parts are uploaded issuing\n  // this call will aggregate the parts on the server into a single object.\n  completeMultipartUpload(bucketName, objectName, uploadId, etags, cb) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError(`Invalid object name: ${objectName}`)\n    }\n    if (!isString(uploadId)) {\n      throw new TypeError('uploadId should be of type \"string\"')\n    }\n    if (!isObject(etags)) {\n      throw new TypeError('etags should be of type \"Array\"')\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('cb should be of type \"function\"')\n    }\n\n    if (!uploadId) {\n      throw new errors.InvalidArgumentError('uploadId cannot be empty')\n    }\n\n    var method = 'POST'\n    var query = `uploadId=${uriEscape(uploadId)}`\n\n    var parts = []\n\n    etags.forEach(element => {\n      parts.push({\n        Part: [{\n          PartNumber: element.part\n        }, {\n          ETag: element.etag\n        }]\n      })\n    })\n\n    var payloadObject = {CompleteMultipartUpload: parts}\n    var payload = Xml(payloadObject)\n\n    this.makeRequest({method, bucketName, objectName, query}, payload, 200, '', true, (e, response) => {\n      if (e) return cb(e)\n      var transformer = transformers.getCompleteMultipartTransformer()\n      pipesetup(response, transformer)\n        .on('error', e => cb(e))\n        .on('data', result => {\n          if (result.errCode) {\n            // Multipart Complete API returns an error XML after a 200 http status\n            cb(new errors.S3Error(result.errMessage))\n          } else {\n            cb(null, result.etag)\n          }\n        })\n    })\n  }\n\n  // Get part-info of all parts of an incomplete upload specified by uploadId.\n  listParts(bucketName, objectName, uploadId, cb) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError(`Invalid object name: ${objectName}`)\n    }\n    if (!isString(uploadId)) {\n      throw new TypeError('uploadId should be of type \"string\"')\n    }\n    if (!uploadId) {\n      throw new errors.InvalidArgumentError('uploadId cannot be empty')\n    }\n    var parts = []\n    var listNext = (marker) => {\n      this.listPartsQuery(bucketName, objectName, uploadId, marker, (e, result) => {\n        if (e) {\n          cb(e)\n          return\n        }\n        parts = parts.concat(result.parts)\n        if (result.isTruncated) {\n          listNext(result.marker)\n          return\n        }\n        cb(null, parts)\n      })\n    }\n    listNext(0)\n  }\n\n  // Called by listParts to fetch a batch of part-info\n  listPartsQuery(bucketName, objectName, uploadId, marker, cb) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError(`Invalid object name: ${objectName}`)\n    }\n    if (!isString(uploadId)) {\n      throw new TypeError('uploadId should be of type \"string\"')\n    }\n    if (!isNumber(marker)) {\n      throw new TypeError('marker should be of type \"number\"')\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n    if (!uploadId) {\n      throw new errors.InvalidArgumentError('uploadId cannot be empty')\n    }\n    var query = ''\n    if (marker && marker !== 0) {\n      query += `part-number-marker=${marker}&`\n    }\n    query += `uploadId=${uriEscape(uploadId)}`\n\n    var method = 'GET'\n    this.makeRequest({method, bucketName, objectName, query}, '', 200, '', true, (e, response) => {\n      if (e) return cb(e)\n      var transformer = transformers.getListPartsTransformer()\n      pipesetup(response, transformer)\n        .on('error', e => cb(e))\n        .on('data', data => cb(null, data))\n    })\n  }\n\n  // Called by listIncompleteUploads to fetch a batch of incomplete uploads.\n  listIncompleteUploadsQuery(bucketName, prefix, keyMarker, uploadIdMarker, delimiter) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isString(prefix)) {\n      throw new TypeError('prefix should be of type \"string\"')\n    }\n    if (!isString(keyMarker)) {\n      throw new TypeError('keyMarker should be of type \"string\"')\n    }\n    if (!isString(uploadIdMarker)) {\n      throw new TypeError('uploadIdMarker should be of type \"string\"')\n    }\n    if (!isString(delimiter)) {\n      throw new TypeError('delimiter should be of type \"string\"')\n    }\n    var queries = []\n    queries.push(`prefix=${uriEscape(prefix)}`)\n    queries.push(`delimiter=${uriEscape(delimiter)}`)\n\n    if (keyMarker) {\n      keyMarker = uriEscape(keyMarker)\n      queries.push(`key-marker=${keyMarker}`)\n    }\n    if (uploadIdMarker) {\n      queries.push(`upload-id-marker=${uploadIdMarker}`)\n    }\n\n    var maxUploads = 1000\n    queries.push(`max-uploads=${maxUploads}`)\n    queries.sort()\n    queries.unshift('uploads')\n    var query = ''\n    if (queries.length > 0) {\n      query = `${queries.join('&')}`\n    }\n    var method = 'GET'\n    var transformer = transformers.getListMultipartTransformer()\n    this.makeRequest({method, bucketName, query}, '', 200, '', true, (e, response) => {\n      if (e) return transformer.emit('error', e)\n      pipesetup(response, transformer)\n    })\n    return transformer\n  }\n\n  // Find uploadId of an incomplete upload.\n  findUploadId(bucketName, objectName, cb) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError(`Invalid object name: ${objectName}`)\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('cb should be of type \"function\"')\n    }\n    var latestUpload\n    var listNext = (keyMarker, uploadIdMarker) => {\n      this.listIncompleteUploadsQuery(bucketName, objectName, keyMarker, uploadIdMarker, '')\n        .on('error', e => cb(e))\n        .on('data', result => {\n          result.uploads.forEach(upload => {\n            if (upload.key === objectName) {\n              if (!latestUpload ||\n                (upload.initiated.getTime() > latestUpload.initiated.getTime())) {\n                latestUpload = upload\n                return\n              }\n            }\n          })\n          if (result.isTruncated) {\n            listNext(result.nextKeyMarker, result.nextUploadIdMarker)\n            return\n          }\n          if (latestUpload) return cb(null, latestUpload.uploadId)\n          cb(null, undefined)\n        })\n    }\n    listNext('', '')\n  }\n\n  // Returns a function that can be used for uploading objects.\n  // If multipart === true, it returns function that is used to upload\n  // a part of the multipart.\n  getUploader(bucketName, objectName, metaData, multipart) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError(`Invalid object name: ${objectName}`)\n    }\n    if (!isBoolean(multipart)) {\n      throw new TypeError('multipart should be of type \"boolean\"')\n    }\n    if (!isObject(metaData)) {\n      throw new TypeError('metadata should be of type \"object\"')\n    }\n\n    var validate = (stream, length, sha256sum, md5sum, cb) => {\n      if (!isReadableStream(stream)) {\n        throw new TypeError('stream should be of type \"Stream\"')\n      }\n      if (!isNumber(length)) {\n        throw new TypeError('length should be of type \"number\"')\n      }\n      if (!isString(sha256sum)) {\n        throw new TypeError('sha256sum should be of type \"string\"')\n      }\n      if (!isString(md5sum)) {\n        throw new TypeError('md5sum should be of type \"string\"')\n      }\n      if (!isFunction(cb)) {\n        throw new TypeError('callback should be of type \"function\"')\n      }\n    }\n    var simpleUploader = (...args) => {\n      validate(...args)\n      var query = ''\n      upload(query, ...args)\n    }\n    var multipartUploader = (uploadId, partNumber, ...rest) => {\n      if (!isString(uploadId)) {\n        throw new TypeError('uploadId should be of type \"string\"')\n      }\n      if (!isNumber(partNumber)) {\n        throw new TypeError('partNumber should be of type \"number\"')\n      }\n      if (!uploadId) {\n        throw new errors.InvalidArgumentError('Empty uploadId')\n      }\n      if (!partNumber) {\n        throw new errors.InvalidArgumentError('partNumber cannot be 0')\n      }\n      validate(...rest)\n      var query = `partNumber=${partNumber}&uploadId=${uriEscape(uploadId)}`\n      upload(query, ...rest)\n    }\n    var upload = (query, stream, length, sha256sum, md5sum, cb) => {\n      var method = 'PUT'\n      let headers = {'Content-Length': length}\n\n      if (!multipart) {\n        headers = Object.assign({}, metaData, headers)\n      }\n\n      if (!this.enableSHA256) headers['Content-MD5'] = md5sum\n      this.makeRequestStream({method, bucketName, objectName, query, headers},\n                             stream, sha256sum, 200, '', true, (e, response) => {\n                               if (e) return cb(e)\n                               var etag = response.headers.etag\n                               if (etag) {\n                                 etag = etag.replace(/^\"/, '').replace(/\"$/, '')\n                               }\n                               // Ignore the 'data' event so that the stream closes. (nodejs stream requirement)\n                               response.on('data', () => {})\n                               cb(null, etag)\n                             })\n    }\n    if (multipart) {\n      return multipartUploader\n    }\n    return simpleUploader\n  }\n\n  // Remove all the notification configurations in the S3 provider\n  setBucketNotification(bucketName, config, cb) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isObject(config)) {\n      throw new TypeError('notification config should be of type \"Object\"')\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n    var method = 'PUT'\n    var query = 'notification'\n    var builder = new xml2js.Builder({rootName:'NotificationConfiguration', renderOpts:{'pretty':false}, headless:true})\n    var payload = builder.buildObject(config)\n    this.makeRequest({method, bucketName, query}, payload, 200, '', false, cb)\n  }\n\n  removeAllBucketNotification(bucketName, cb) {\n    this.setBucketNotification(bucketName, new NotificationConfig(), cb)\n  }\n\n  // Return the list of notification configurations stored\n  // in the S3 provider\n  getBucketNotification(bucketName, cb) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError('Invalid bucket name: ' + bucketName)\n    }\n    if (!isFunction(cb)) {\n      throw new TypeError('callback should be of type \"function\"')\n    }\n    var method = 'GET'\n    var query = 'notification'\n    this.makeRequest({method, bucketName, query}, '', 200, '', true, (e, response) => {\n      if (e) return cb(e)\n      var transformer = transformers.getBucketNotificationTransformer()\n      var bucketNotification\n      pipesetup(response, transformer)\n        .on('data', result => bucketNotification = result)\n        .on('error', e => cb(e))\n        .on('end', () => cb(null, bucketNotification))\n    })\n  }\n\n  // Listens for bucket notifications. Returns an EventEmitter.\n  listenBucketNotification(bucketName, prefix, suffix, events) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError(`Invalid bucket name: ${bucketName}`)\n    }\n    if (!isString(prefix)) {\n      throw new TypeError('prefix must be of type string')\n    }\n    if (!isString(suffix)) {\n      throw new TypeError('suffix must be of type string')\n    }\n    if (!isArray(events)) {\n      throw new TypeError('events must be of type Array')\n    }\n    let listener = new NotificationPoller(this, bucketName, prefix, suffix, events)\n    listener.start()\n\n    return listener\n  }\n\n  get extensions() {\n    if(!this.clientExtensions)\n    {\n      this.clientExtensions = new extensions(this)\n    }\n    return this.clientExtensions\n  }\n}\n\n// Promisify various public-facing APIs on the Client module.\nClient.prototype.makeBucket = promisify(Client.prototype.makeBucket)\nClient.prototype.listBuckets = promisify(Client.prototype.listBuckets)\nClient.prototype.bucketExists = promisify(Client.prototype.bucketExists)\nClient.prototype.removeBucket = promisify(Client.prototype.removeBucket)\n\nClient.prototype.getObject = promisify(Client.prototype.getObject)\nClient.prototype.getPartialObject = promisify(Client.prototype.getPartialObject)\nClient.prototype.fGetObject = promisify(Client.prototype.fGetObject)\nClient.prototype.putObject = promisify(Client.prototype.putObject)\nClient.prototype.fPutObject = promisify(Client.prototype.fPutObject)\nClient.prototype.copyObject = promisify(Client.prototype.copyObject)\nClient.prototype.statObject = promisify(Client.prototype.statObject)\nClient.prototype.removeObject = promisify(Client.prototype.removeObject)\nClient.prototype.removeObjects = promisify(Client.prototype.removeObjects)\n\nClient.prototype.presignedUrl = promisify(Client.prototype.presignedUrl)\nClient.prototype.presignedGetObject = promisify(Client.prototype.presignedGetObject)\nClient.prototype.presignedPutObject = promisify(Client.prototype.presignedPutObject)\nClient.prototype.presignedPostPolicy = promisify(Client.prototype.presignedPostPolicy)\nClient.prototype.getBucketNotification = promisify(Client.prototype.getBucketNotification)\nClient.prototype.setBucketNotification = promisify(Client.prototype.setBucketNotification)\nClient.prototype.removeAllBucketNotification = promisify(Client.prototype.removeAllBucketNotification)\nClient.prototype.getBucketPolicy = promisify(Client.prototype.getBucketPolicy)\nClient.prototype.setBucketPolicy = promisify(Client.prototype.setBucketPolicy)\nClient.prototype.removeIncompleteUpload = promisify(Client.prototype.removeIncompleteUpload)\n\n\nexport class CopyConditions {\n  constructor() {\n    this.modified = \"\"\n    this.unmodified = \"\"\n    this.matchETag = \"\"\n    this.matchETagExcept = \"\"\n  }\n\n  setModified(date) {\n    if (!(date instanceof Date))\n      throw new TypeError('date must be of type Date')\n\n    this.modified = date.toUTCString()\n  }\n\n  setUnmodified(date) {\n    if (!(date instanceof Date))\n      throw new TypeError('date must be of type Date')\n\n    this.unmodified = date.toUTCString()\n  }\n\n  setMatchETag(etag) {\n    this.matchETag = etag\n  }\n\n  setMatchETagExcept(etag) {\n    this.matchETagExcept = etag\n  }\n}\n\n// Build PostPolicy object that can be signed by presignedPostPolicy\nexport class PostPolicy {\n  constructor() {\n    this.policy = {\n      conditions: []\n    }\n    this.formData = {}\n  }\n\n  // set expiration date\n  setExpires(date) {\n    if (!date) {\n      throw new errors.InvalidDateError('Invalid date : cannot be null')\n    }\n    this.policy.expiration = date.toISOString()\n  }\n\n  // set object name\n  setKey(objectName) {\n    if (!isValidObjectName(objectName)) {\n      throw new errors.InvalidObjectNameError(`Invalid object name : ${objectName}`)\n    }\n    this.policy.conditions.push(['eq', '$key', objectName])\n    this.formData.key = objectName\n  }\n\n  // set object name prefix, i.e policy allows any keys with this prefix\n  setKeyStartsWith(prefix) {\n    if (!isValidPrefix(prefix)) {\n      throw new errors.InvalidPrefixError(`Invalid prefix : ${prefix}`)\n    }\n    this.policy.conditions.push(['starts-with', '$key', prefix])\n    this.formData.key = prefix\n  }\n\n  // set bucket name\n  setBucket(bucketName) {\n    if (!isValidBucketName(bucketName)) {\n      throw new errors.InvalidBucketNameError(`Invalid bucket name : ${bucketName}`)\n    }\n    this.policy.conditions.push(['eq', '$bucket', bucketName])\n    this.formData.bucket = bucketName\n  }\n\n  // set Content-Type\n  setContentType(type) {\n    if (!type) {\n      throw new Error('content-type cannot be null')\n    }\n    this.policy.conditions.push(['eq', '$Content-Type', type])\n    this.formData['Content-Type'] = type\n  }\n\n  // set minimum/maximum length of what Content-Length can be.\n  setContentLengthRange(min, max) {\n    if (min > max) {\n      throw new Error('min cannot be more than max')\n    }\n    if (min < 0) {\n      throw new Error('min should be > 0')\n    }\n    if (max < 0) {\n      throw new Error('max should be > 0')\n    }\n    this.policy.conditions.push(['content-length-range', min, max])\n  }\n}\n\nexport * from './notification'\n"],"file":"minio.js"}